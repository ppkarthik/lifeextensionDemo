var stjude=stjude||{};
stjude.dprforms=stjude.dprforms||{};
stjude.dprforms.donationamount=(function(g,j,u){var v;
var A;
var w;
var o;
var m;
var n;
var d;
var x;
var l;
var y=false;
function k(){g("#donationAmountOther").css("height",(g("#otherPaymentChoice-close").height()-4)+"px").css("line-height",(g("#otherPaymentChoice-close").height()-4)+"px");
g("#dollarSign").css("line-height",g("#otherPaymentChoice-close").height()+"px")
}function h(){g(".amountsWrapper").hide();
g(".amountOtherWrapper").show();
k();
g.publish("/dprforms/formUpdate")
}function c(){g(".amountOtherWrapper").hide();
g(".amountsWrapper").show();
g("#otherPaymentChoice").removeClass("selected");
g("#donationAmountOther").val("");
g("#donationAmountOther").removeClass("error");
g(".amountOption").trigger("blur");
if(g("#makeMonthly").attr("checked")||g("#monthly").attr("checked")){if(g.inArray(m,d)<0){r(d[0])
}else{r(m)
}}else{if(g.inArray(n,x)<0){r(x[0])
}else{r(n)
}}g("#amount p.error").remove();
k();
g.publish("/dprforms/formUpdate")
}function i(){g("#donationAmountOther").val("").focus()
}function f(){if(g("#Other-amt").attr("checked")||g("#amountsWrapper").length<1){if(g("input[name=donationAmountOther]").val()==undefined||g("input[name=donationAmountOther]").val().length==0){return""
}else{return g("input[name=donationAmountOther]").val()
}}else{return g("input[name=donationAmountSelected]:checked").val()
}}function t(D){if(g("#Other-amt").attr("checked")||g("#amountsWrapper").length<1){if(g("input[name=donationAmountOther]").val()==undefined||g("input[name=donationAmountOther]").val().length==0){return""
}else{return g("input[name=donationAmountOther]").val()
}}else{if(y){return g("input[name=donationAmountSelected]:checked").val()
}else{if(D==="monthly"){return m
}else{return n
}}}}function q(F,E){var D=t(E);
if(E==="monthly"){z(d,D)
}else{z(x,D)
}}function p(){g.publish("/dprforms/amount",f())
}function b(D){g("#donationAmountOther").rules("add",{required:true,number:true,min:v,max:A,messages:{required:D.donationAmountOther+v,number:D.donationAmountOtherMoney,min:D.donationAmountOther+v,max:D.donationAmountOtherMaxFirstPart+A.toLocaleString()+D.donationAmountOtherMaxSecondPart,pattern:D.donationAmountOtherMoney}})
}function e(D){return g(".amountsWrapper label").filter(function(){g(this).removeClass("selected");
g(this).next().attr("checked",false);
return D==g(this).text().replace("$","")
})
}function C(){var D=stjude.dprforms.dprutils.getParameterByName("amount");
if(D){r(D)
}}function B(D){return D.reduce(function(G,E,F){return G+'<label for="option'+(F+1)+'" class="amountOption" >$'+E+'</label><input type="radio" id="option'+(F+1)+'" name="donationAmountSelected" value="'+E+'" class="required">'
},"")
}function z(G,F){var D=stjude.dprforms.dprutils.getParameterByName("amount");
var E=g(".optionsWrapper");
if(E.length){E.html(B(G));
r(F);
k();
stjude.dprforms.formutils.initRadio(o);
g("input[name=donationAmountSelected]").change(function(){if(g("#Other-amt").attr("checked")){h();
i()
}else{g("#amount p.error").remove()
}p()
})
}}function r(D){g(".amountsWrapper").show();
g(".amountOtherWrapper").hide();
var E=e(D);
if(E.length){E.addClass("selected");
E.next().attr("checked",true)
}else{g(".amountsWrapper").hide();
g(".amountOtherWrapper").show();
g(".amountOtherWrapper > #donationAmountOther").val(D);
g("#Other-amt").attr("checked",true)
}p()
}function a(D){o=D.nodeId;
v=Number(D.min);
A=Number(D.max);
m=D.monthlyDefaultAmount;
n=D.oneTimeDefaultAmount;
d=D.monthlyAmountOptions.split(",");
x=D.oneTimeAmountOptions.split(",");
l=D.defaultAmountManual
}function s(){var D=/^\d+\.\d$/;
var E=g("#donationAmountOther").val();
if(E!=undefined&&E!=""&&D.test(E)){E=parseFloat(E).toFixed(2)
}g("#donationAmountOther").val(E)
}return{init:function(G){a(G);
var D=stjude.dprforms.dprutils.getParameterByName("amount");
var E=stjude.dprforms.dprutils.getParameterByName("frequency_selected");
w=g("#amount label").first().width();
var F=g("#amountsWrapper");
if(F.length){if(E==1){z(d,m)
}else{z(x,n)
}}if(D){y=true;
r(D)
}else{if(F.length<1){r(l)
}}C();
if(g("#Other-amt").is(":checked")==true){h()
}if(navigator.userAgent.toLowerCase().indexOf("firefox")>-1){g("input[name=donationAmountOther]").prop("type","text")
}g("input[name=donationAmountOther]").change(function(){y=true;
s();
p()
});
g("#otherPaymentChoice-close").click(function(){c();
p()
});
g(".otherClose").click(function(H){H.preventDefault();
c();
y=false;
p()
});
g(".optionsWrapper").change(function(){y=true;
p()
});
k();
s();
b(G);
g(j).resize(function(){k()
});
g.subscribe("/dprforms/frequency",q)
},getDonationAmount:function(){return f()
}}
})(jQuery,window,document);